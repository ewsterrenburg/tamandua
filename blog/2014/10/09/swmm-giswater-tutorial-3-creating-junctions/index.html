<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PILOSA.EU, Scribblings of World's Most Curious Anteater">


        <link rel="alternate" href="http://pilosa.eu/feed.xml" type="application/rss+xml" title="PILOSA.EU Full RSS Feed"/>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
        <title>EPA SWMM / Giswater Tutorial 3: CreatingÂ Junctions // PILOSA.EU // Scribblings of World's Most Curious Anteater</title>

    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://pilosa.eu/theme/css/pure.css">
    <link rel="stylesheet" href="http://pilosa.eu/theme/css/pygments.css">

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background-image: url('/images/bananas.jpeg')">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
                            <h1 class="brand-main"><a href="http://pilosa.eu">PILOSA.EU</a></h1>
                            <p class="tagline">Scribblings of World's Most Curious Anteater</p>
                                <p class="links"><a href="http://pilosa.eu/archives.html">Archive</a></p>
                                <p class="links"><a href="http://pilosa.eu/about.html">About</a></p>
                                <p class="social">
                                    <a href="mailto:ewsterrenburg@gmail.com">
                                        <i class="fa fa-envelope-o fa-3x"></i>
                                    </a>
                                    <a href="https://github.com/ewsterrenburg/">
                                        <i class="fa fa-github fa-3x"></i>
                                    </a>
                                    <a href="https://www.linkedin.com/in/ewsterrenburg/">
                                        <i class="fa fa-linkedin fa-3x"></i>
                                    </a>
                                    <a href="http://pilosa.eu/feed.xml">
                                        <i class="fa fa-rss fa-3x"></i>
                                    </a>
                                <p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1><span class="caps">EPA</span> <span class="caps">SWMM</span> / Giswater Tutorial 3: Creating&nbsp;Junctions</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="http://pilosa.eu/tag/swmm.html">SWMM</a>
                                <a class="post-category" href="http://pilosa.eu/tag/giswater.html">Giswater</a>
                                <a class="post-category" href="http://pilosa.eu/tag/water.html">Water</a>
                        </p>
                </header>
            </section>
            <p>This is the 3<sup>rd</sup> episode in my tutorial on using <span class="caps">EPA</span> Storm Water Management Model (<span class="caps">EPA</span> <span class="caps">SWMM</span>) and Giswater for rainfall-runoff modeling for an urban drainage network system. This episode describes how to create junctions in <span class="caps">EPA</span> <span class="caps">SWMM</span>, using <span class="caps">QGIS</span> and using <span class="caps">SQL</span> insert&nbsp;statements. </p>
<p>The wonderful <span class="caps">EPA</span> <span class="caps">SWMM</span> help provides us with the following information on&nbsp;junctions:</p>
<blockquote>
<p>Junctions are drainage system nodes where links join together.
  Physically they can represent the confluence of natural surface channels,
  manholes in a sewer system, or pipe connection fittings.
  External inflows can enter the system at junctions.
  Excess water at a junction can become partially pressurized while
  connecting conduits are surcharged and can either be lost from the system
  or be allowed to pond atop the junction and subsequently drain back into the&nbsp;junction.</p>
<p>The principal input parameters for a junction&nbsp;are:</p>
<ul>
<li>invert&nbsp;elevation;</li>
<li>height to ground surface: maximum depth at the junction (i.e., the distance from the invert to the ground surface) (feet or meters). If zero, then the distance from the invert to the top of the highest connecting link will be&nbsp;used;</li>
<li>ponded surface area when flooded&nbsp;(optional);</li>
<li>external inflow data&nbsp;(optional).</li>
</ul>
</blockquote>
<p>For now, we keep it as simple as possible and leave the two optional attributes for later. However, there are some other attributes that may seem trivial, yet still require&nbsp;attention:</p>
<ul>
<li>Geometry;</li>
<li>X-coordinate;</li>
<li>Y-coordinate;</li>
<li>NodeID.</li>
</ul>
<h1 id="epa-swmm"><span class="caps">EPA</span> <span class="caps">SWMM</span></h1>
<p>The graphical user interface of <span class="caps">EPA</span> <span class="caps">SWMM</span> provides two ways to create a new&nbsp;node:</p>
<ol>
<li>It is possible to draw a new node on the map, in which case the location where you click the map is used to determine the X- and&nbsp;Y-coordinate;</li>
<li>The other way around is to navigate to junctions in the tree view in the tree view, select &#8220;junctions&#8221; by using the left mouse button, followed by pressing the &#8220;Add new&#8221; button. Using this approach, the location on the map where the junction is placed is determined based on the values supplied for the X- and&nbsp;Y-coordinate.</li>
</ol>
<p><img alt="SWMM_create_junction" src="/images/SWMM_create_junction.png" title="Creating a junction in EPA SWMM." /></p>
<p>In both cases, a NodeID is automatically generated using an autoincrementor, with the prefixes and increment supplied in the project defaults (see <a href="/blog/2014/09/20/swmm-giswater-tutorial-2-project-setup/">Episode 2: Project Setup</a>).
It is possible to replace this automatically generated NodeID with your own value, yet each node should have an unique <span class="caps">ID</span>. This constrained is enforced by the&nbsp;software.</p>
<p>Double-clicking on a node opens it&#8217;s attribute form in which the attributes can be modified.
The location of a junction can be changed by dragging the junction to a new location, or by changing the X- and Y-attributes. A selected node can be removed by pressing the &#8220;Delete&#8221; key on your keyboard, or by using the &#8220;Delete object&#8221; button next to the &#8220;Add new&#8221;&nbsp;button.</p>
<h1 id="giswater-qgis-as-frontdoor"><span class="caps">GISWATER</span>: <span class="caps">QGIS</span> <span class="caps">AS</span> <span class="caps">FRONTDOOR</span></h1>
<p>The Giswater equivalent of drawing a junction in <span class="caps">EPA</span> <span class="caps">SWMM</span> directly, would be to draw a new feature in in the junction layer of the corresponding <span class="caps">GIS</span>-project. This approach offers the following&nbsp;advantages:</p>
<ul>
<li>Adding basemaps;<sup id="fnref:backdrop_image"><a class="footnote-ref" href="#fn:backdrop_image" rel="footnote">1</a></sup></li>
<li>Adding your own geo-spatial data as a reference, to snap new objects on or to copy-paste the geometry into the <span class="caps">SWMM</span>&nbsp;layers;</li>
<li>Sophisticated drawing tools (cadtools, Autotrace, <span class="caps">GPS</span>) availabe as&nbsp;plugins;</li>
<li>A field calculator to update attributes in&nbsp;bulk.</li>
</ul>
<h3 id="sectors">Sectors</h3>
<p>Giswater introduces the concept of sectors. I haven&#8217;t found out yet whether using sectors in your data is required or not. I&#8217;ll ignore them for now and come back to this either when I&#8217;ll make an episode on the functioning of sectors or when the calculation refuses to run <i class="fa fa-smile-o"></i>.</p>
<h3 id="drawing-new-junctions">Drawing new&nbsp;junctions</h3>
<p><img alt="QGIS_create_junctions" src="/images/QGIS_create_junctions.png" title="Creating junctions in QGIS." /></p>
<ol>
<li>Make the Junctions layer (<strong><span class="caps">EPA</span> <span class="caps">SWMM</span> <span class="caps">DATA</span></strong> <i class="fa fa-long-arrow-right"></i> <strong>Hydraulics</strong> <i class="fa fa-long-arrow-right"></i> <strong>Node</strong> <i class="fa fa-long-arrow-right"></i> <strong>Junctions</strong> ) active by clicking on this layer in the content tree of the&nbsp;map;</li>
<li>Toggle editing (<strong>a</strong>);</li>
<li>Add new features (<strong>b</strong>);</li>
<li>In the attribute form, supply values for node_id, top_elev, ymax and optionally for the other attributes (<strong>c</strong>);</li>
<li>Save layer edits (<strong>d</strong>).</li>
</ol>
<h3 id="copy-paste-new-junctions">Copy - Paste new&nbsp;junctions</h3>
<ol>
<li>Make the source layer for the junctions to be pasted&nbsp;active;</li>
<li>Toggle editing of this layer (<strong>a</strong>);</li>
<li>Select the features to be copied using the selection tools provided by <span class="caps">QGIS</span>;</li>
<li>Click &#8220;Copy features&#8221; button (<strong>e</strong>);</li>
<li>Make the Junctions layer&nbsp;active;</li>
<li>Toggle editing (<strong>a</strong>);</li>
<li>Paste features (<strong>f</strong>);</li>
<li>If attributes with the same name were present in the source layer, they will be transferred over. Otherwise, supply values for node_id, top_elev, ymax and optionally for the other attributes (<strong>c</strong>);</li>
<li>Save layer edits (<strong>d</strong>).</li>
</ol>
<h3 id="modify-the-location-of-a-junction">Modify the location of a&nbsp;junction</h3>
<ol>
<li>Make the Junctions layer&nbsp;active;</li>
<li>Toggle editing (<strong>a</strong>);</li>
<li>Move features (<strong>g</strong>);</li>
<li>Drag junction to new&nbsp;location;</li>
<li>Save layer edits (<strong>d</strong>).</li>
</ol>
<h3 id="modify-the-attributes-of-a-junction">Modify the attributes of a&nbsp;junction</h3>
<ol>
<li>Make the Junctions layer&nbsp;active;</li>
<li>Toggle editing (<strong>a</strong>);</li>
<li>Open the attribute form using the &#8220;Identify Features&#8221; button (<strong>i</strong>) or open the attribute table (<strong>j</strong>);</li>
<li>Fill in the new attribute values (<strong>c</strong>);    </li>
<li>Save layer edits (<strong>d</strong>).</li>
</ol>
<h3 id="delete-a-junction">Delete a&nbsp;junction</h3>
<ol>
<li>Make the Junctions layer&nbsp;active;</li>
<li>Toggle editing (<strong>a</strong>);</li>
<li>Select&nbsp;features;</li>
<li>Delete selected using the &#8220;Delete selected&#8221; button (<strong>h</strong>) or pressing the &#8220;Delete&#8221;&nbsp;key;</li>
<li>Save layer edits (<strong>d</strong>).</li>
</ol>
<h3 id="important-donts">Important <span class="caps">DON</span>&#8217;Ts</h3>
<ul>
<li>Do <strong><em><span class="caps">NOT</span></em></strong> mess around in the nodes layer or in the results layers!!! Drawing in these layers will not activate the required database functions to create new objects&nbsp;correctly.</li>
<li>Make sure your Postgres server is running when starting the <span class="caps">QGIS</span> project (i.e. do not close the command prompt window of the portable Postgres). If the server stops with your <span class="caps">GIS</span>-project open, <span class="caps">QGIS</span> will spit out a endless loop of pop-ups stating that it is not able to reach the server. <span class="caps">QGIS</span> can now only be stopped with&nbsp;violence.</li>
</ul>
<h1 id="giswater-sql-as-backdoor"><span class="caps">GISWATER</span>: <span class="caps">SQL</span> <span class="caps">AS</span> <span class="caps">BACKDOOR</span></h1>
<p>When you are drawing a drainage system from scratch, <span class="caps">QGIS</span> (or other <span class="caps">GIS</span> software configured for editing the correct tables) would be the way to go. However, in many cases information is already available from other sources (<span class="caps">CAD</span>-drawings, geodatabases, Excel-files, etc.). In these cases, you could also use scripting to interpret this information and insert it into the database. These insert queries could directly be executed from your code, yet I like to keep insight in what is happening. Therefore, my approach was to use python scripts which write the insert queries to a <span class="caps">SQL</span>-script. </p>
<p>If X- and Y-coordinates are available, the value to be inserted in the geometry field can be generated using <a href="http://www.fabianowski.eu/projects/ppygis/">PPyGIS</a>. Although in the documentation is stated that PPyGIS is young and has several limitations, it does this job really well. The following python code generates insert statements for 4 junctions in a strictly random street somewhere in the east of the&nbsp;Netherlands:</p>
<div class="highlight"><pre><span class="code-line"><span class="kn">import</span> <span class="nn">ppygis</span></span>
<span class="code-line"><span class="kn">import</span> <span class="nn">psycopg2</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">SRID</span> <span class="o">=</span> <span class="mi">28992</span></span>
<span class="code-line"><span class="n">schema</span> <span class="o">=</span> <span class="s">&#39;tutorial&#39;</span></span>
<span class="code-line"><span class="n">junction_view</span> <span class="o">=</span> <span class="s">&#39;v_inp_edit_junction&#39;</span></span>
<span class="code-line"><span class="n">junction_fields</span> <span class="o">=</span> <span class="s">&#39;(node_id, top_elev, ymax, y0, ysur, apond, sector_id, the_geom)&#39;</span></span>
<span class="code-line"><span class="n">junction_query</span> <span class="o">=</span> <span class="s">r&#39;INSERT INTO &quot;{0}&quot;.&quot;{1}&quot; {2} VALUES (</span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">, </span><span class="si">%s</span><span class="s">);&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">junction_view</span><span class="p">,</span> <span class="n">junction_fields</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">class</span> <span class="nc">junction</span><span class="p">():</span></span>
<span class="code-line">    <span class="sd">&#39;&#39;&#39;</span></span>
<span class="code-line"><span class="sd">    This is a junction</span></span>
<span class="code-line"><span class="sd">    &#39;&#39;&#39;</span></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">NodeID</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">):</span></span>
<span class="code-line">        <span class="sd">&#39;&#39;&#39;</span></span>
<span class="code-line"><span class="sd">        Constructor</span></span>
<span class="code-line"><span class="sd">        &#39;&#39;&#39;</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">NodeID</span> <span class="o">=</span> <span class="n">NodeID</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">Z</span> <span class="o">=</span> <span class="n">Z</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">MaxDepth</span> <span class="o">=</span> <span class="mi">0</span>           <span class="c"># take values from connected reaches</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">InitDepth</span> <span class="o">=</span> <span class="mi">0</span>          <span class="c"># 0 for now, to be examined later</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">SurchargeDepth</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c"># optional, to be examined later</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">PondingArea</span> <span class="o">=</span> <span class="mi">0</span>        <span class="c"># optional, to be examined later</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">SectorID</span> <span class="o">=</span> <span class="bp">None</span>        <span class="c"># ignore for now, to be examined later</span></span>
<span class="code-line">        <span class="bp">self</span><span class="o">.</span><span class="n">Geometry</span> <span class="o">=</span> <span class="n">ppygis</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">srid</span><span class="o">=</span><span class="n">SRID</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="nd">@property</span></span>
<span class="code-line">    <span class="k">def</span> <span class="nf">InsertValues</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></span>
<span class="code-line">        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">NodeID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MaxDepth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">InitDepth</span><span class="p">,</span> \</span>
<span class="code-line">                <span class="bp">self</span><span class="o">.</span><span class="n">SurchargeDepth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">PondingArea</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">SectorID</span><span class="p">,</span> \</span>
<span class="code-line">                <span class="bp">self</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">write_ewkb</span><span class="p">())</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">conn</span> <span class="o">=</span> <span class="n">psycopg2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;dbname=giswater_ddb user=postgres port=5431&#39;</span><span class="p">)</span></span>
<span class="code-line"><span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="c"># Here you can put the logic that reads out the files/databases</span></span>
<span class="code-line"><span class="c"># that contain locations and/or attributes of your junctions</span></span>
<span class="code-line"><span class="n">node_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;J1&#39;</span><span class="p">,</span> <span class="s">&#39;J2&#39;</span><span class="p">,</span> <span class="s">&#39;J3&#39;</span><span class="p">,</span> <span class="s">&#39;J4&#39;</span><span class="p">]</span></span>
<span class="code-line"><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">255320.35</span><span class="p">,</span> <span class="mf">255347.98</span><span class="p">,</span> <span class="mf">255365.84</span><span class="p">,</span> <span class="mf">255375.21</span><span class="p">]</span></span>
<span class="code-line"><span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mf">472276.25</span><span class="p">,</span> <span class="mf">472302.63</span><span class="p">,</span> <span class="mf">472319.22</span><span class="p">,</span> <span class="mf">472328.19</span><span class="p">]</span></span>
<span class="code-line"><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">33.11</span><span class="p">,</span> <span class="mf">33.03</span><span class="p">,</span> <span class="mf">32.76</span><span class="p">,</span> <span class="mf">32.89</span><span class="p">]</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span></span>
<span class="code-line">    <span class="n">example_junction</span> <span class="o">=</span> <span class="n">junction</span><span class="p">(</span><span class="n">node_ids</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></span>
<span class="code-line">    <span class="n">junction_values</span> <span class="o">=</span>  <span class="n">example_junction</span><span class="o">.</span><span class="n">InsertValues</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="c"># and write the resulting query to a file, not stdout</span></span>
<span class="code-line">    <span class="k">print</span> <span class="n">cur</span><span class="o">.</span><span class="n">mogrify</span><span class="p">(</span><span class="n">junction_query</span><span class="p">,</span> <span class="n">junction_values</span><span class="p">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></span>
</pre></div>


<p>Which results in the following <span class="caps">SQL</span>-statement:</p>
<div class="highlight"><pre><span class="code-line"><span class="n">INSERT</span> <span class="n">INTO</span> <span class="s">&quot;tutorial&quot;</span><span class="p">.</span><span class="s">&quot;v_inp_edit_junction&quot;</span> <span class="n">VALUES</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">J1</span><span class="err">&#39;</span><span class="p">,</span> <span class="mf">33.11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">None</span><span class="p">,</span> <span class="err">&#39;</span><span class="mo">010100002040710000</span><span class="n">cdccccccc22a0f410000000051d31c41</span><span class="err">&#39;</span><span class="p">);</span></span>
<span class="code-line"><span class="n">INSERT</span> <span class="n">INTO</span> <span class="s">&quot;tutorial&quot;</span><span class="p">.</span><span class="s">&quot;v_inp_edit_junction&quot;</span> <span class="n">VALUES</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">J2</span><span class="err">&#39;</span><span class="p">,</span> <span class="mf">33.03</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">None</span><span class="p">,</span> <span class="err">&#39;</span><span class="mo">010100002040710000713</span><span class="n">d0ad79f2b0f4152b81e85bad31c41</span><span class="err">&#39;</span><span class="p">);</span></span>
<span class="code-line"><span class="n">INSERT</span> <span class="n">INTO</span> <span class="s">&quot;tutorial&quot;</span><span class="p">.</span><span class="s">&quot;v_inp_edit_junction&quot;</span> <span class="n">VALUES</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">J3</span><span class="err">&#39;</span><span class="p">,</span> <span class="mf">32.76</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">None</span><span class="p">,</span> <span class="err">&#39;</span><span class="mo">010100002040710000</span><span class="mi">85</span><span class="n">eb51b82e2c0f4114ae47e1fcd31c41</span><span class="err">&#39;</span><span class="p">);</span></span>
<span class="code-line"><span class="n">INSERT</span> <span class="n">INTO</span> <span class="s">&quot;tutorial&quot;</span><span class="p">.</span><span class="s">&quot;v_inp_edit_junction&quot;</span> <span class="n">VALUES</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">J4</span><span class="err">&#39;</span><span class="p">,</span> <span class="mf">32.89</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">None</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">010100002040710000e17</span><span class="n">a14ae792c0f41295c8fc220d41c41</span><span class="err">&#39;</span><span class="p">);</span></span>
</pre></div>


<p>As you can see, this insert query should also executed on the view that contains the junctions, not directly on the node table. Update and delete queries should also be performed on this&nbsp;view.</p>
<h1 id="conclusions"><span class="caps">CONCLUSIONS</span>:</h1>
<p><span class="caps">QGIS</span> provides much more powerful tools to draw and modify your objects than using <span class="caps">EPA</span> <span class="caps">SWMM</span> directly. 
No incremental IDs are handed out automatically, yet the field calculator provides a powerful tool ot generate them in bulk. Data integrity is maintained by the database trigger and constraints. This works works well, however you need to be <strong><em>really</em></strong> careful to make your edits to the correct&nbsp;layer.</p>
<h3 id="open-ends">Open&nbsp;ends:</h3>
<ul>
<li>The description and <span class="caps">TAG</span> attributes of the junctions are not present in Giswater. Within a <span class="caps">GIS</span>-environment, there is less need for this functionality. However including the description attribute would be a minor development effort. Supporting the use of tags might need more&nbsp;effort;</li>
<li>Giswater introduces the concepts of sectors. It is not yet clear to me what their function is and whether it is required to use&nbsp;them;</li>
<li>The initial depth does not seem to be explicitly mentioned in the <span class="caps">EPA</span> <span class="caps">SWMM</span> help. This attribute will need to be examined&nbsp;further.</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:backdrop_image">
<p>It is possible to add a street map, utility map, topographic map, site development plan, or any other relevant picture or drawing as a backdrop image in <span class="caps">EPA</span> <span class="caps">SWMM</span>.This can be useful, yet &#8230; to a proper <span class="caps">GIS</span>-environment.&#160;<a class="footnote-backref" href="#fnref:backdrop_image" rev="footnote" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
            <a href="#" class="go-top">Go Top</a>
    <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "pilosa"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
<footer class="footer">
    <p>&copy; Erwin Sterrenburg &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-53900294-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script>

</body>
</html>