<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PILOSA.EU, Scribblings of World's Most Curious Anteater">


        <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="PILOSA.EU Full RSS Feed"/>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
        <title>EPA SWMM / Giswater Tutorial 3: Creating Junctions // PILOSA.EU // Scribblings of World's Most Curious Anteater</title>

    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/pure/0.3.0/pure-min.css">
    <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="http://pilosa.eu/theme/css/pure.css">
    <link rel="stylesheet" href="http://pilosa.eu/theme/css/pygments.css">

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/fitvids/1.0.1/jquery.fitvids.min.js"></script>
    <script>
        $(document).ready(function(){
            $(".content").fitVids();
        });
    </script>
</head>

<body>
    <div class="pure-g-r" id="layout">
        <div class="sidebar pure-u">
            <div class="cover-img" style="background-image: url('/images/bananas.jpeg')">
                <div class="cover-body">
                    <header class="header">
                        <hgroup>
                            <h1 class="brand-main"><a href="http://pilosa.eu">PILOSA.EU</a></h1>
                            <p class="tagline">Scribblings of World's Most Curious Anteater</p>
                                <p class="links"><a href="http://pilosa.eu/archives.html">Archive</a></p>
                                <p class="links"><a href="http://pilosa.eu/about.html">About</a></p>
                                <p class="social">
                                    <a href="mailto:ewsterrenburg@gmail.com">
                                        <i class="fa fa-envelope-o fa-3x"></i>
                                    </a>
                                    <a href="https://github.com/ewsterrenburg/">
                                        <i class="fa fa-github fa-3x"></i>
                                    </a>
                                    <a href="https://www.linkedin.com/in/ewsterrenburg">
                                        <i class="fa fa-linkedin fa-3x"></i>
                                    </a>
                                    <a href="feed.xml">
                                        <i class="fa fa-rss fa-3x"></i>
                                    </a>
                                <p>
                        </hgroup>
                    </header>
                </div>
            </div>
        </div>
    <div class="pure-u">
        <div class="content">
            <section class="post">
                <header class="post-header">
                    <h1>EPA SWMM / Giswater Tutorial 3: Creating Junctions</h1>
                        <p class="post-meta">
                            // under                                 <a class="post-category" href="http://pilosa.eu/tag/swmm.html">SWMM</a>
                                <a class="post-category" href="http://pilosa.eu/tag/giswater.html">Giswater</a>
                                <a class="post-category" href="http://pilosa.eu/tag/water.html">Water</a>
                        </p>
                </header>
            </section>
            <p>This is the 3<sup>rd</sup> episode in my tutorial on the using <span class="caps">EPA</span> Storm Water Management Model (<span class="caps">EPA</span> <span class="caps">SWMM</span>) and Giswater for rainfall-runoff modeling for an urban drainage network system. This episodes describes how to create junctions in <span class="caps">EPA</span> <span class="caps">SWMM</span>, using <span class="caps">QGIS</span> and using <span class="caps">SQL</span> insert&nbsp;statements. </p>
<p>The (&#8230; elaborate) <span class="caps">SWMM</span> help provides us with the following information on&nbsp;junctions:</p>
<blockquote>
<p>Junctions are drainage system nodes where links join together.
  Physically they can represent the confluence of natural surface channels,
  manholes in a sewer system, or pipe connection fittings.
  External inflows can enter the system at junctions.
  Excess water at a junction can become partially pressurized while
  connecting conduits are surcharged and can either be lost from the system
  or be allowed to pond atop the junction and subsequently drain back into the&nbsp;junction.</p>
<p>The principal input parameters for a junction&nbsp;are:</p>
<ul>
<li>invert&nbsp;elevation.</li>
<li>height to ground surface (Maximum depth at the junction (i.e., the distance from the invert to the ground surface) (feet or meters). If zero, then the distance from the invert to the top of the highest connecting link will be used.&nbsp;).</li>
<li>ponded surface area when flooded&nbsp;(optional).</li>
<li>external inflow data&nbsp;(optional).</li>
</ul>
</blockquote>
<p>For now, we keep it as simple as possible and leave the two optional attributes for later. However, there are some other attributes that may seem trivial, yet still require&nbsp;attention:</p>
<ul>
<li>Geometry</li>
<li>X-coordinate</li>
<li>Y-coordinate</li>
<li>NodeID</li>
</ul>
<h1 id="epa-swmm"><span class="caps">EPA</span> <span class="caps">SWMM</span></h1>
<p>The graphical user interface of <span class="caps">EPA</span> <span class="caps">SWMM</span> prodides two ways to create a new node.
It is possible to draw a new node on the map, in which case the location where you click the map is used to determine the X- and Y-coordinate.
The other way around is to &#8230;, in which case the location on the map where the junction is placed is determined based on the values supplied for the X- and Y-coordinate.
In both cases, a nodeID is automatically generated using an autoincrementor, with the prefixes and increment supplied in the project defaults (zie deel 2!). 
It is possible to replace the automatically generated NodeID with your own value, yet each node should have an unique <span class="caps">ID</span>. This constrained is enforced by the&nbsp;software.</p>
<h1 id="giswater-qgis-as-frontdoor"><span class="caps">GISWATER</span>: <span class="caps">QGIS</span> <span class="caps">AS</span> <span class="caps">FRONTDOOR</span></h1>
<p>The Giswater equivalent of drawing a junction in <span class="caps">EPA</span> <span class="caps">SWMM</span> directly, would be to draw a new feature in in the junction layer of the corresponding <span class="caps">GIS</span>-project.
advantages over&nbsp;&#8230;:</p>
<ul>
<li>Possibility to add basemaps (voetnoot: <span class="caps">EPA</span> basemaps make you&nbsp;cry);</li>
<li>Possibility to add your own geospatial data as a reference, snap new objects on these features and paste the geometry of these features in your <span class="caps">SWMM</span>&nbsp;layers;</li>
<li>More power full drawing tools. Standard already &#8230;, for more <span class="caps">CAD</span>-like functionality, tracing etc, there are plugins&nbsp;available;</li>
<li>A field calculator to update attributes in&nbsp;bulk.</li>
</ul>
<p>[<span class="caps">PLAATJE</span>?]</p>
<h3 id="sectors">Sectors</h3>
<p><strong><em><span class="caps">SECTORS</span></em></strong></p>
<ol>
<li>toggle editing of &#8230;&nbsp;layers</li>
<li>draw new&nbsp;feature</li>
<li><span class="caps">NODEID</span>, sector_ID, &#8230;, &#8230;, handmatig (or field calculator&nbsp;:))</li>
<li>save&nbsp;edits.</li>
</ol>
<h3 id="drawing-new-junctions">Drawing new&nbsp;junctions</h3>
<p>[plaatje?]</p>
<ol>
<li>toggle editing of &#8230;&nbsp;layers</li>
<li>draw new&nbsp;feature</li>
<li><span class="caps">NODEID</span>, sector_ID, &#8230;, &#8230;, handmatig (or field calculator&nbsp;:))</li>
<li>save&nbsp;edits.</li>
</ol>
<h3 id="copy-paste-new-junctions">Copy - Paste new&nbsp;junctions:</h3>
<p>[plaatje?]</p>
<ol>
<li>make source layer active&nbsp;(click)</li>
<li>toggle editing of source layers&nbsp;(nodig?)</li>
<li>select features to be&nbsp;copied</li>
<li>click copy&nbsp;button</li>
<li>activate target layer (i.e. junction&nbsp;layer)</li>
<li>toggle editing of target&nbsp;layers</li>
<li>paste&nbsp;features</li>
<li><span class="caps">NODEID</span>, sector_ID, &#8230;,&nbsp;&#8230;,</li>
<li>save&nbsp;edits</li>
</ol>
<h3 id="important-donts">Important <span class="caps">DON</span>&#8217;Ts</h3>
<ul>
<li><strong>do <em>++<span class="caps">NOT</span>++</em> mess around in the nodes layer or in the results layers!!! Drawing in these layers will not activate the required database functions to &#8230; the new objects in the correct&nbsp;way.</strong></li>
<li><strong>Make sure your Postgres server is running when starting the <span class="caps">QGIS</span> project (i.e. do not close the &#8230; of the portable postgres). server sluiten:&nbsp;huilen</strong></li>
</ul>
<h1 id="giswater-sql-as-backdoor"><span class="caps">GISWATER</span>: <span class="caps">SQL</span> <span class="caps">AS</span> <span class="caps">BACKDOOR</span></h1>
<p>Drawing a new system: <span class="caps">QGIS</span> (or other <span class="caps">GIS</span> software configured for editing the correct tables). However, in many cases information already available from other sources (<span class="caps">CAD</span>-drawings, geodatabases, &#8230;, etc.). In these case, you could use scripting to .. this information and &#8230; into the database. The insert queries could directly be executed by your code, yet I like to keep insight in what is happening. Therefore, my approach was to use python scripts which write the insert queries to a&nbsp;file. </p>
<p>For the geometry: ppygis can be&nbsp;helpful</p>
<p>node.node_id, node.top_elev, node.ymax, inp_junction.y0,
    inp_junction.ysur, inp_junction.apond, node.sector_id,&nbsp;node.the_geom</p>
<div class="highlight"><pre><span class="n">INSERT</span> <span class="n">INTO</span> <span class="s">&quot;test_zanderij_31121&quot;</span><span class="p">.</span><span class="s">&quot;v_inp_edit_junction&quot;</span> <span class="n">VALUES</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">C3422736</span><span class="err">&#39;</span><span class="p">,</span> <span class="mf">2.23</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">sector_01</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="mf">010100002091790000f853e3655</span><span class="n">a0f2141ec51b81ebbbb2341</span><span class="err">&#39;</span><span class="p">);</span>
</pre></div>


<ul>
<li>directly inserting into the&nbsp;database</li>
<li>make sure you use&nbsp;v_edit_inp_junction</li>
<li>triggers op nieuwe&nbsp;putten</li>
<li>wat gebeurt er bij update/delete (en wat met gekoppelde&nbsp;strengen?)</li>
</ul>
<h1 id="conclusions">Conclusions:</h1>
<p>much more powerful ways to &#8230; and keep them&nbsp;up-to-date</p>
<h3 id="open-ends">Open&nbsp;ends:</h3>
<p>Geometrie &#8212;&gt; X/Y, niet andersom! (wat bedoel ik hier in vredesnaam&nbsp;mee?)</p>
<p>Description / <span class="caps">TAG</span> missing in <span class="caps">GISWATER</span>?
<span class="caps">GISWATER</span> introduces the concepts of Sectors
Initial depth is not explicitly mentioned, what to do with this?
ponded surface area when flooded (optional).
external inflow data&nbsp;(optional).</p>
            <a href="#" class="go-top">Go Top</a>
    <div class="comments">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = "pilosa"; // required: replace example with your forum shortname

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
<footer class="footer">
    <p>&copy; Erwin Sterrenburg &ndash;
        Built with <a href="https://github.com/PurePelicanTheme/pure-single">Pure Theme</a>
        for <a href="http://blog.getpelican.com/">Pelican</a>
    </p>
</footer>        </div>
    </div>
    </div>
    <script>
        var $top = $('.go-top');

        // Show or hide the sticky footer button
        $(window).scroll(function() {
            if ($(this).scrollTop() > 200) {
                $top.fadeIn(200);
            } else {
                $top.fadeOut(200);
            }
        });

        // Animate the scroll to top
        $top.click(function(event) {
            event.preventDefault();
            $('html, body').animate({scrollTop: 0}, 300);
        })

        // Makes sure that the href="#" attached to the <a> elements
        // don't scroll you back up the page.
        $('body').on('click', 'a[href="#"]', function(event) {
            event.preventDefault();
        });
    </script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-53900294-1");
            pageTracker._trackPageview();
            } catch(err) {}
    </script>

</body>
</html>